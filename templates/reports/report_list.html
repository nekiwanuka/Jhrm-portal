{% extends 'base.html' %}
{% block page_title %}Reports{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
	<p class="text-muted m-0">Generate and export administrative reports.</p>
	<div class="d-flex gap-2 flex-wrap">
		<a href="{% url 'reports:create' %}" class="btn btn-primary btn-sm">
			<i class="fa-solid fa-plus me-1"></i> Request Report
		</a>
		<a href="{% url 'reports:export_csv' %}" class="btn btn-outline-success btn-sm">
			<i class="fa-solid fa-file-csv me-1"></i> Export CSV
		</a>
	</div>
</div>

<div class="card">
	<div class="card-body">
		<div class="table-responsive">
			<table class="table table-hover align-middle">
					<thead><tr><th>Requested By</th><th>Type</th><th>Date Range</th><th>Department</th><th>Targets</th><th>Created</th><th class="text-end">Preview</th></tr></thead>
				<tbody>
				{% for report in report_requests %}
					<tr>
						<td class="fw-semibold">{{ report.requested_by.username }}</td>
						<td>{{ report.report_type }}</td>
						<td>{{ report.start_date }} - {{ report.end_date }}</td>
						<td>{{ report.department_name|default:'All' }}</td>
							<td>
								<span class="badge text-bg-light">{{ report.targets_label }}</span>
							</td>
							<td class="text-muted">{{ report.created_at }}</td>
							<td class="text-end">
								<a class="btn btn-outline-primary btn-sm" href="{% url 'reports:detail' report.pk %}">Preview</a>
							</td>
					</tr>
				{% empty %}
						<tr><td colspan="7" class="text-muted">No report requests.</td></tr>
				{% endfor %}
				</tbody>
			</table>
		</div>
	</div>
</div>
{% endblock %}
