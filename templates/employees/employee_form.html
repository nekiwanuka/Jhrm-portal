{% extends 'base.html' %}

{% block page_title %}
  {% if object %}Edit Employee{% else %}Add Employee{% endif %}
{% endblock %}

{% block content %}
<form method="post" enctype="multipart/form-data" class="purpose-form-shell">
  {% csrf_token %}

  <div class="form-steps" aria-label="Employee profile update steps">
    <div class="form-step is-active">
      <span class="form-step-index">1</span>
      <span class="form-step-label">Identity & Access</span>
    </div>
    <div class="form-step is-active">
      <span class="form-step-index">2</span>
      <span class="form-step-label">Work & Compliance</span>
    </div>
    <div class="form-step is-active">
      <span class="form-step-index">3</span>
      <span class="form-step-label">Review & Save</span>
    </div>
  </div>

  <p class="purpose-form-subtitle mb-3">Manage employee account, organization assignment, identification, and employment profile details.</p>

  {% if form.non_field_errors %}
    <div class="alert alert-danger">
      {% for error in form.non_field_errors %}
        <div>{{ error }}</div>
      {% endfor %}
    </div>
  {% endif %}

  <div class="row g-3">
    <div class="col-lg-6">
      <div class="card h-100">
        <div class="card-header">Account & Identity</div>
        <div class="card-body">
          <div class="mb-3">
            <label class="form-label" for="{{ form.user.id_for_label }}">{{ form.user.label }}</label>
            {{ form.user }}
            {% for error in form.user.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
          </div>
          <div class="mb-3">
            <label class="form-label" for="{{ form.employee_id.id_for_label }}">{{ form.employee_id.label }}</label>
            {{ form.employee_id }}
            {% for error in form.employee_id.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
          </div>
          <div class="mb-3">
            <label class="form-label" for="{{ form.photo.id_for_label }}">{{ form.photo.label }}</label>
            {{ form.photo }}
            {% for error in form.photo.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
          </div>
        </div>
      </div>
    </div>

    <div class="col-lg-6">
      <div class="card h-100">
        <div class="card-header">Organization</div>
        <div class="card-body">
          <div class="mb-3">
            <label class="form-label" for="{{ form.department.id_for_label }}">{{ form.department.label }}</label>
            {{ form.department }}
            {% for error in form.department.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
          </div>
          <div class="mb-3">
            <label class="form-label" for="{{ form.position.id_for_label }}">{{ form.position.label }}</label>
            {{ form.position }}
            {% for error in form.position.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
          </div>
          <div class="mb-3">
            <label class="form-label" for="{{ form.primary_role.id_for_label }}">{{ form.primary_role.label }}</label>
            {{ form.primary_role }}
            {% if form.primary_role.help_text %}
              <div class="form-text">{{ form.primary_role.help_text }}</div>
            {% endif %}
            {% for error in form.primary_role.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
          </div>
        </div>
      </div>
    </div>

    <div class="col-lg-6">
      <div class="card h-100">
        <div class="card-header">Personal Identification</div>
        <div class="card-body">
          <div class="mb-3"><label class="form-label" for="{{ form.national_id.id_for_label }}">{{ form.national_id.label }}</label>{{ form.national_id }}{% for error in form.national_id.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}</div>
          <div class="mb-3"><label class="form-label" for="{{ form.passport_number.id_for_label }}">{{ form.passport_number.label }}</label>{{ form.passport_number }}{% for error in form.passport_number.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}</div>
          <div class="mb-3"><label class="form-label" for="{{ form.tin.id_for_label }}">{{ form.tin.label }}</label>{{ form.tin }}{% for error in form.tin.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}</div>
          <div class="mb-3"><label class="form-label" for="{{ form.nssf_number.id_for_label }}">{{ form.nssf_number.label }}</label>{{ form.nssf_number }}{% for error in form.nssf_number.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}</div>
          <div class="mb-3"><label class="form-label" for="{{ form.date_of_birth.id_for_label }}">{{ form.date_of_birth.label }}</label>{{ form.date_of_birth }}{% for error in form.date_of_birth.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}</div>
          <div class="mb-3"><label class="form-label" for="{{ form.gender.id_for_label }}">{{ form.gender.label }}</label>{{ form.gender }}{% for error in form.gender.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}</div>
          <div class="mb-3"><label class="form-label" for="{{ form.marital_status.id_for_label }}">{{ form.marital_status.label }}</label>{{ form.marital_status }}{% for error in form.marital_status.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}</div>
        </div>
      </div>
    </div>

    <div class="col-lg-6">
      <div class="card h-100">
        <div class="card-header">Emergency Contact</div>
        <div class="card-body">
          <div class="mb-3"><label class="form-label" for="{{ form.emergency_contact_name.id_for_label }}">{{ form.emergency_contact_name.label }}</label>{{ form.emergency_contact_name }}{% for error in form.emergency_contact_name.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}</div>
          <div class="mb-3"><label class="form-label" for="{{ form.emergency_contact_phone.id_for_label }}">{{ form.emergency_contact_phone.label }}</label>{{ form.emergency_contact_phone }}{% for error in form.emergency_contact_phone.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}</div>
        </div>
      </div>
    </div>

    <div class="col-lg-6">
      <div class="card h-100">
        <div class="card-header">Employment</div>
        <div class="card-body">
          <div class="mb-3"><label class="form-label" for="{{ form.employment_type.id_for_label }}">{{ form.employment_type.label }}</label>{{ form.employment_type }}{% for error in form.employment_type.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}</div>
          <div class="mb-3"><label class="form-label" for="{{ form.date_hired.id_for_label }}">{{ form.date_hired.label }}</label>{{ form.date_hired }}{% for error in form.date_hired.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}</div>
          <div class="mb-3"><label class="form-label" for="{{ form.probation_end_date.id_for_label }}">{{ form.probation_end_date.label }}</label>{{ form.probation_end_date }}{% for error in form.probation_end_date.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}</div>
          <div class="mb-3"><label class="form-label" for="{{ form.status.id_for_label }}">{{ form.status.label }}</label>{{ form.status }}{% for error in form.status.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}</div>
        </div>
      </div>
    </div>

    <div class="col-lg-6">
      <div class="card h-100">
        <div class="card-header">Banking</div>
        <div class="card-body">
          <div class="mb-3"><label class="form-label" for="{{ form.bank_name.id_for_label }}">{{ form.bank_name.label }}</label>{{ form.bank_name }}{% for error in form.bank_name.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}</div>
          <div class="mb-3"><label class="form-label" for="{{ form.bank_account_number.id_for_label }}">{{ form.bank_account_number.label }}</label>{{ form.bank_account_number }}{% for error in form.bank_account_number.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}</div>
          <div class="mb-3"><label class="form-label" for="{{ form.bank_branch.id_for_label }}">{{ form.bank_branch.label }}</label>{{ form.bank_branch }}{% for error in form.bank_branch.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}</div>
        </div>
      </div>
    </div>
  </div>

  <div class="mt-3 d-flex gap-2">
    <button class="btn btn-primary" type="submit">Save Employee</button>
    <a class="btn btn-outline-secondary" href="{% url 'employees:list' %}">Cancel</a>
  </div>
</form>
{% endblock %}
